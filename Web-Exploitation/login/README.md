### Name: login
### File: none
### Description: My dog-sitter's brother made this website but I can't get in; can you help? login.mars.picoctf.net
### Points: 100

We are presented with a simple login form, requiring username and password. The first thing that I always do in these tasks is inspecting the website
for useful information (cookies, scripts, comments, requests etc.). 

Sure enough, a script called `index.js` is used. Upon inspecting this file, all of the code is written on a single line. 
Using an [online tool for prettyfying](https://beautifier.io/) the code gives us the following: 

```javascript
(async () => {
    await new Promise((e => window.addEventListener("load", e))), document.querySelector("form").addEventListener("submit", (e => {
        e.preventDefault();
        const r = {
                u: "input[name=username]",
                p: "input[name=password]"
            },
            t = {};
        for (const e in r) t[e] = btoa(document.querySelector(r[e]).value).replace(/=/g, "");
        return "YWRtaW4" !== t.u ? alert("Incorrect Username") : "cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ" !== t.p ? alert("Incorrect Password") : void alert(`Correct Password! Your flag is ${atob(t.p)}.`)
    }))
})();
```
Looking at the code, it seems the username and password is hardcoded, and only a single combination will give us the flag. 
The encoded values look like Base64, and so I used a custom script that I created for [common string encodings](https://github.com/GGrottan/Snake-potion-of-minor-decipherment) used in CTF tasks.

At first, the script didn't work, however, I noticed that the given Base64 didn't have any padding to it (`=`). By adding the padding manually,
the script worked as intended: 

Username:
```console
> python3 spomd.py -B -m YWRtaW4=

======

admin

======

```

Password:

```console
> python3 spomd.py -B -m cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ==

============================================

picoCTF{53rv3r_53rv3r_53rv3r_53rv3r_53rv3r}

============================================
```

Entering these credentials gives us an alert message with the flag ðŸš©:

```text
Correct Password! Your flag is picoCTF{53rv3r_53rv3r_53rv3r_53rv3r_53rv3r}.
```



